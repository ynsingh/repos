<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7 : Virtual lab admin interface : /admin/oauth/Zend/Http/Client/Adapter/Proxy.php source</title>
    <link rel="stylesheet" href="../../../../../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../../../../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../../../../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Virtual lab admin interface</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7 at Tue Dec  7 15:36:31 2010 -->
<!-- PHPXref (c) 2000-2007 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../../../../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../../../../../';
subdir='admin/oauth/Zend/Http/Client/Adapter';
filename='Proxy.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../../../../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../../../../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../../../../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../../../../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../../../../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../../../../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/admin/oauth/Zend/Http/Client/Adapter/</a> -> <a href="Proxy.php.html">Proxy.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="Proxy.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="Proxy.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">/**</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment"> * Zend Framework</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment"> *</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment"> * LICENSE</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment"> *</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment"> * This source file is subject to the new BSD license that is bundled</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment"> * with this package in the file LICENSE.txt.</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment"> * It is also available through the world-wide-web at this URL:</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment"> * http://framework.zend.com/license/new-bsd</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment"> * If you did not receive a copy of the license and are unable to</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment"> * obtain it through the world-wide-web, please send an email</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment"> * to license@zend.com so we can send you a copy immediately.</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment"> *</span>
<a name="l16"><span class="linenum">  16</span></a>  <span class="comment"> * @category   Zend</span>
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment"> * @package    Zend_Http</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * @subpackage Client_Adapter</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> * @version    $Id: Proxy.php 20947 2010-02-06 17:09:07Z padraic $</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * @copyright  Copyright (c) 2005-2010 Zend Technologies USA Inc. (http://www.zend.com)</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * @license    http://framework.zend.com/license/new-bsd     New BSD License</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> */</span>
<a name="l23"><span class="linenum">  23</span></a>  
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment">/**</span>
<a name="l25"><span class="linenum">  25</span></a>  <span class="comment"> * @see Zend_Uri_Http</span>
<a name="l26"><span class="linenum">  26</span></a>  <span class="comment"> */</span>
<a name="l27"><span class="linenum">  27</span></a>  require_once 'Zend/Uri/Http.php';
<a name="l28"><span class="linenum">  28</span></a>  <span class="comment">/**</span>
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment"> * @see Zend_Http_Client</span>
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment"> */</span>
<a name="l31"><span class="linenum">  31</span></a>  require_once 'Zend/Http/Client.php';
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment">/**</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> * @see Zend_Http_Client_Adapter_Socket</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> */</span>
<a name="l35"><span class="linenum">  35</span></a>  require_once 'Zend/Http/Client/Adapter/Socket.php';
<a name="l36"><span class="linenum">  36</span></a>  
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment">/**</span>
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment"> * HTTP Proxy-supporting Zend_Http_Client adapter class, based on the default</span>
<a name="l39"><span class="linenum">  39</span></a>  <span class="comment"> * socket based adapter.</span>
<a name="l40"><span class="linenum">  40</span></a>  <span class="comment"> *</span>
<a name="l41"><span class="linenum">  41</span></a>  <span class="comment"> * Should be used if proxy HTTP access is required. If no proxy is set, will</span>
<a name="l42"><span class="linenum">  42</span></a>  <span class="comment"> * fall back to Zend_Http_Client_Adapter_Socket behavior. Just like the</span>
<a name="l43"><span class="linenum">  43</span></a>  <span class="comment"> * default Socket adapter, this adapter does not require any special extensions</span>
<a name="l44"><span class="linenum">  44</span></a>  <span class="comment"> * installed.</span>
<a name="l45"><span class="linenum">  45</span></a>  <span class="comment"> *</span>
<a name="l46"><span class="linenum">  46</span></a>  <span class="comment"> * @category   Zend</span>
<a name="l47"><span class="linenum">  47</span></a>  <span class="comment"> * @package    Zend_Http</span>
<a name="l48"><span class="linenum">  48</span></a>  <span class="comment"> * @subpackage Client_Adapter</span>
<a name="l49"><span class="linenum">  49</span></a>  <span class="comment"> * @copyright  Copyright (c) 2005-2010 Zend Technologies USA Inc. (http://www.zend.com)</span>
<a name="l50"><span class="linenum">  50</span></a>  <span class="comment"> * @license    http://framework.zend.com/license/new-bsd     New BSD License</span>
<a name="l51"><span class="linenum">  51</span></a>  <span class="comment"> */</span>
<a name="l52"><span class="linenum">  52</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('Zend_Http_Client_Adapter_Proxy')" href="../../../../../../_classes/zend_http_client_adapter_proxy.html" onMouseOver="classPopup(event,'zend_http_client_adapter_proxy')">Zend_Http_Client_Adapter_Proxy</a> <span class="keyword">extends</span> <a class="class" onClick="logClass('Zend_Http_Client_Adapter_Socket')" href="../../../../../../_classes/zend_http_client_adapter_socket.html" onMouseOver="classPopup(event,'zend_http_client_adapter_socket')">Zend_Http_Client_Adapter_Socket</a>
<a name="l53"><span class="linenum">  53</span></a>  {
<a name="l54"><span class="linenum">  54</span></a>      <span class="comment">/**</span>
<a name="l55"><span class="linenum">  55</span></a>  <span class="comment">     * Parameters array</span>
<a name="l56"><span class="linenum">  56</span></a>  <span class="comment">     *</span>
<a name="l57"><span class="linenum">  57</span></a>  <span class="comment">     * @var array</span>
<a name="l58"><span class="linenum">  58</span></a>  <span class="comment">     */</span>
<a name="l59"><span class="linenum">  59</span></a>      protected <a class="var it48" onMouseOver="hilite(48)" onMouseOut="lolite()" onClick="logVariable('config')" href="../../../../../../_variables/config.html">$config</a> = array(
<a name="l60"><span class="linenum">  60</span></a>          'ssltransport'  =&gt; 'ssl',
<a name="l61"><span class="linenum">  61</span></a>          'sslcert'       =&gt; null,
<a name="l62"><span class="linenum">  62</span></a>          'sslpassphrase' =&gt; null,
<a name="l63"><span class="linenum">  63</span></a>          'proxy_host'    =&gt; '',
<a name="l64"><span class="linenum">  64</span></a>          'proxy_port'    =&gt; 8080,
<a name="l65"><span class="linenum">  65</span></a>          'proxy_user'    =&gt; '',
<a name="l66"><span class="linenum">  66</span></a>          'proxy_pass'    =&gt; '',
<a name="l67"><span class="linenum">  67</span></a>          'proxy_auth'    =&gt; <a class="class" onClick="logClass('Zend_Http_Client')" href="../../../../../../_classes/zend_http_client.html" onMouseOver="classPopup(event,'zend_http_client')">Zend_Http_Client</a>::AUTH_BASIC,
<a name="l68"><span class="linenum">  68</span></a>          'persistent'    =&gt; false
<a name="l69"><span class="linenum">  69</span></a>      );
<a name="l70"><span class="linenum">  70</span></a>  
<a name="l71"><span class="linenum">  71</span></a>      <span class="comment">/**</span>
<a name="l72"><span class="linenum">  72</span></a>  <span class="comment">     * Whether HTTPS CONNECT was already negotiated with the proxy or not</span>
<a name="l73"><span class="linenum">  73</span></a>  <span class="comment">     *</span>
<a name="l74"><span class="linenum">  74</span></a>  <span class="comment">     * @var boolean</span>
<a name="l75"><span class="linenum">  75</span></a>  <span class="comment">     */</span>
<a name="l76"><span class="linenum">  76</span></a>      protected <a class="var it893" onMouseOver="hilite(893)" onMouseOut="lolite()" onClick="logVariable('negotiated')" href="../../../../../../_variables/negotiated.html">$negotiated</a> = false;
<a name="l77"><span class="linenum">  77</span></a>  
<a name="l78"><span class="linenum">  78</span></a>      <span class="comment">/**</span>
<a name="l79"><span class="linenum">  79</span></a>  <span class="comment">     * Connect to the remote server</span>
<a name="l80"><span class="linenum">  80</span></a>  <span class="comment">     *</span>
<a name="l81"><span class="linenum">  81</span></a>  <span class="comment">     * Will try to connect to the proxy server. If no proxy was set, will</span>
<a name="l82"><span class="linenum">  82</span></a>  <span class="comment">     * fall back to the target server (behave like regular Socket adapter)</span>
<a name="l83"><span class="linenum">  83</span></a>  <span class="comment">     *</span>
<a name="l84"><span class="linenum">  84</span></a>  <span class="comment">     * @param string  $host</span>
<a name="l85"><span class="linenum">  85</span></a>  <span class="comment">     * @param int     $port</span>
<a name="l86"><span class="linenum">  86</span></a>  <span class="comment">     * @param boolean $secure</span>
<a name="l87"><span class="linenum">  87</span></a>  <span class="comment">     */</span>
<a name="l88"><span class="linenum">  88</span></a>      public function <a class="function" onClick="logFunction('connect')" href="../../../../../../_functions/connect.html" onMouseOver="funcPopup(event,'connect')">connect</a>(<a class="var it268" onMouseOver="hilite(268)" onMouseOut="lolite()" onClick="logVariable('host')" href="../../../../../../_variables/host.html">$host</a>, <a class="var it269" onMouseOver="hilite(269)" onMouseOut="lolite()" onClick="logVariable('port')" href="../../../../../../_variables/port.html">$port</a> = 80, <a class="var it270" onMouseOver="hilite(270)" onMouseOut="lolite()" onClick="logVariable('secure')" href="../../../../../../_variables/secure.html">$secure</a> = false)
<a name="l89"><span class="linenum">  89</span></a>      {
<a name="l90"><span class="linenum">  90</span></a>  <span class="comment">        // If no proxy is set, fall back to Socket adapter</span>
<a name="l91"><span class="linenum">  91</span></a>          if (! <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/config.html">config</a>['proxy_host']) {
<a name="l92"><span class="linenum">  92</span></a>              return parent::<a class="function" onClick="logFunction('connect')" href="../../../../../../_functions/connect.html" onMouseOver="funcPopup(event,'connect')">connect</a>(<a class="var it268" onMouseOver="hilite(268)" onMouseOut="lolite()" onClick="logVariable('host')" href="../../../../../../_variables/host.html">$host</a>, <a class="var it269" onMouseOver="hilite(269)" onMouseOut="lolite()" onClick="logVariable('port')" href="../../../../../../_variables/port.html">$port</a>, <a class="var it270" onMouseOver="hilite(270)" onMouseOut="lolite()" onClick="logVariable('secure')" href="../../../../../../_variables/secure.html">$secure</a>);
<a name="l93"><span class="linenum">  93</span></a>          }
<a name="l94"><span class="linenum">  94</span></a>          
<a name="l95"><span class="linenum">  95</span></a>  <span class="comment">        /* Url might require stream context even if proxy connection doesn't */</span>
<a name="l96"><span class="linenum">  96</span></a>          if (<a class="var it270" onMouseOver="hilite(270)" onMouseOut="lolite()" onClick="logVariable('secure')" href="../../../../../../_variables/secure.html">$secure</a>) {
<a name="l97"><span class="linenum">  97</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/config.html">config</a>['sslusecontext'] = true;
<a name="l98"><span class="linenum">  98</span></a>          }
<a name="l99"><span class="linenum">  99</span></a>  
<a name="l100"><span class="linenum"> 100</span></a>  <span class="comment">        // Connect (a non-secure connection) to the proxy server</span>
<a name="l101"><span class="linenum"> 101</span></a>          return parent::<a class="function" onClick="logFunction('connect')" href="../../../../../../_functions/connect.html" onMouseOver="funcPopup(event,'connect')">connect</a>(
<a name="l102"><span class="linenum"> 102</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/config.html">config</a>['proxy_host'],
<a name="l103"><span class="linenum"> 103</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/config.html">config</a>['proxy_port'],
<a name="l104"><span class="linenum"> 104</span></a>              false
<a name="l105"><span class="linenum"> 105</span></a>          );
<a name="l106"><span class="linenum"> 106</span></a>      }
<a name="l107"><span class="linenum"> 107</span></a>  
<a name="l108"><span class="linenum"> 108</span></a>      <span class="comment">/**</span>
<a name="l109"><span class="linenum"> 109</span></a>  <span class="comment">     * Send request to the proxy server</span>
<a name="l110"><span class="linenum"> 110</span></a>  <span class="comment">     *</span>
<a name="l111"><span class="linenum"> 111</span></a>  <span class="comment">     * @param string        $method</span>
<a name="l112"><span class="linenum"> 112</span></a>  <span class="comment">     * @param Zend_Uri_Http $uri</span>
<a name="l113"><span class="linenum"> 113</span></a>  <span class="comment">     * @param string        $http_ver</span>
<a name="l114"><span class="linenum"> 114</span></a>  <span class="comment">     * @param array         $headers</span>
<a name="l115"><span class="linenum"> 115</span></a>  <span class="comment">     * @param string        $body</span>
<a name="l116"><span class="linenum"> 116</span></a>  <span class="comment">     * @return string Request as string</span>
<a name="l117"><span class="linenum"> 117</span></a>  <span class="comment">     */</span>
<a name="l118"><span class="linenum"> 118</span></a>      public function <a class="function" onClick="logFunction('write')" href="../../../../../../_functions/write.html" onMouseOver="funcPopup(event,'write')">write</a>(<a class="var it271" onMouseOver="hilite(271)" onMouseOut="lolite()" onClick="logVariable('method')" href="../../../../../../_variables/method.html">$method</a>, <a class="var it38" onMouseOver="hilite(38)" onMouseOut="lolite()" onClick="logVariable('uri')" href="../../../../../../_variables/uri.html">$uri</a>, <a class="var it553" onMouseOver="hilite(553)" onMouseOut="lolite()" onClick="logVariable('http_ver')" href="../../../../../../_variables/http_ver.html">$http_ver</a> = '1.1', <a class="var it41" onMouseOver="hilite(41)" onMouseOut="lolite()" onClick="logVariable('headers')" href="../../../../../../_variables/headers.html">$headers</a> = array(), <a class="var it47" onMouseOver="hilite(47)" onMouseOut="lolite()" onClick="logVariable('body')" href="../../../../../../_variables/body.html">$body</a> = '')
<a name="l119"><span class="linenum"> 119</span></a>      {
<a name="l120"><span class="linenum"> 120</span></a>  <span class="comment">        // If no proxy is set, fall back to default Socket adapter</span>
<a name="l121"><span class="linenum"> 121</span></a>          if (! <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/config.html">config</a>['proxy_host']) return parent::<a class="function" onClick="logFunction('write')" href="../../../../../../_functions/write.html" onMouseOver="funcPopup(event,'write')">write</a>(<a class="var it271" onMouseOver="hilite(271)" onMouseOut="lolite()" onClick="logVariable('method')" href="../../../../../../_variables/method.html">$method</a>, <a class="var it38" onMouseOver="hilite(38)" onMouseOut="lolite()" onClick="logVariable('uri')" href="../../../../../../_variables/uri.html">$uri</a>, <a class="var it553" onMouseOver="hilite(553)" onMouseOut="lolite()" onClick="logVariable('http_ver')" href="../../../../../../_variables/http_ver.html">$http_ver</a>, <a class="var it41" onMouseOver="hilite(41)" onMouseOut="lolite()" onClick="logVariable('headers')" href="../../../../../../_variables/headers.html">$headers</a>, <a class="var it47" onMouseOver="hilite(47)" onMouseOut="lolite()" onClick="logVariable('body')" href="../../../../../../_variables/body.html">$body</a>);
<a name="l122"><span class="linenum"> 122</span></a>  
<a name="l123"><span class="linenum"> 123</span></a>  <span class="comment">        // Make sure we're properly connected</span>
<a name="l124"><span class="linenum"> 124</span></a>          if (! <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('socket')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/socket.html">socket</a>) {
<a name="l125"><span class="linenum"> 125</span></a>              require_once 'Zend/Http/Client/Adapter/Exception.php';
<a name="l126"><span class="linenum"> 126</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('Zend_Http_Client_Adapter_Exception')" href="../../../../../../_classes/zend_http_client_adapter_exception.html" onMouseOver="classPopup(event,'zend_http_client_adapter_exception')">Zend_Http_Client_Adapter_Exception</a>(&quot;Trying to write but we are not connected&quot;);
<a name="l127"><span class="linenum"> 127</span></a>          }
<a name="l128"><span class="linenum"> 128</span></a>  
<a name="l129"><span class="linenum"> 129</span></a>          <a class="var it268" onMouseOver="hilite(268)" onMouseOut="lolite()" onClick="logVariable('host')" href="../../../../../../_variables/host.html">$host</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/config.html">config</a>['proxy_host'];
<a name="l130"><span class="linenum"> 130</span></a>          <a class="var it269" onMouseOver="hilite(269)" onMouseOut="lolite()" onClick="logVariable('port')" href="../../../../../../_variables/port.html">$port</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/config.html">config</a>['proxy_port'];
<a name="l131"><span class="linenum"> 131</span></a>  
<a name="l132"><span class="linenum"> 132</span></a>          if (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('connected_to')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/connected_to.html">connected_to</a>[0] != &quot;tcp://<a class="var it268" onMouseOver="hilite(268)" onMouseOut="lolite()" onClick="logVariable('host')" href="../../../../../../_variables/host.html">$host</a>&quot; || <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('connected_to')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/connected_to.html">connected_to</a>[1] != <a class="var it269" onMouseOver="hilite(269)" onMouseOut="lolite()" onClick="logVariable('port')" href="../../../../../../_variables/port.html">$port</a>) {
<a name="l133"><span class="linenum"> 133</span></a>              require_once 'Zend/Http/Client/Adapter/Exception.php';
<a name="l134"><span class="linenum"> 134</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('Zend_Http_Client_Adapter_Exception')" href="../../../../../../_classes/zend_http_client_adapter_exception.html" onMouseOver="classPopup(event,'zend_http_client_adapter_exception')">Zend_Http_Client_Adapter_Exception</a>(&quot;Trying to write but we are connected to the wrong proxy server&quot;);
<a name="l135"><span class="linenum"> 135</span></a>          }
<a name="l136"><span class="linenum"> 136</span></a>  
<a name="l137"><span class="linenum"> 137</span></a>  <span class="comment">        // Add Proxy-Authorization header</span>
<a name="l138"><span class="linenum"> 138</span></a>          if (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/config.html">config</a>['proxy_user'] &amp;&amp; ! isset(<a class="var it41" onMouseOver="hilite(41)" onMouseOut="lolite()" onClick="logVariable('headers')" href="../../../../../../_variables/headers.html">$headers</a>['proxy-authorization'])) {
<a name="l139"><span class="linenum"> 139</span></a>              <a class="var it41" onMouseOver="hilite(41)" onMouseOut="lolite()" onClick="logVariable('headers')" href="../../../../../../_variables/headers.html">$headers</a>['proxy-authorization'] = <a class="class" onClick="logClass('Zend_Http_Client')" href="../../../../../../_classes/zend_http_client.html" onMouseOver="classPopup(event,'zend_http_client')">Zend_Http_Client</a>::<a class="function" onClick="logFunction('encodeAuthHeader')" href="../../../../../../_functions/encodeauthheader.html" onMouseOver="funcPopup(event,'encodeauthheader')">encodeAuthHeader</a>(
<a name="l140"><span class="linenum"> 140</span></a>                  <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/config.html">config</a>['proxy_user'], <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/config.html">config</a>['proxy_pass'], <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/config.html">config</a>['proxy_auth']
<a name="l141"><span class="linenum"> 141</span></a>              );
<a name="l142"><span class="linenum"> 142</span></a>          }
<a name="l143"><span class="linenum"> 143</span></a>  
<a name="l144"><span class="linenum"> 144</span></a>  <span class="comment">        // if we are proxying HTTPS, preform CONNECT handshake with the proxy</span>
<a name="l145"><span class="linenum"> 145</span></a>          if (<a class="var it38" onMouseOver="hilite(38)" onMouseOut="lolite()" onClick="logVariable('uri')" href="../../../../../../_variables/uri.html">$uri</a>-&gt;<a class="function" onClick="logFunction('getScheme')" href="../../../../../../_functions/getscheme.html" onMouseOver="funcPopup(event,'getscheme')">getScheme</a>() == 'https' &amp;&amp; (! <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('negotiated')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/negotiated.html">negotiated</a>)) {
<a name="l146"><span class="linenum"> 146</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('connectHandshake')" href="../../../../../../_functions/connecthandshake.html" onMouseOver="funcPopup(event,'connecthandshake')">connectHandshake</a>(<a class="var it38" onMouseOver="hilite(38)" onMouseOut="lolite()" onClick="logVariable('uri')" href="../../../../../../_variables/uri.html">$uri</a>-&gt;<a class="function" onClick="logFunction('getHost')" href="../../../../../../_functions/gethost.html" onMouseOver="funcPopup(event,'gethost')">getHost</a>(), <a class="var it38" onMouseOver="hilite(38)" onMouseOut="lolite()" onClick="logVariable('uri')" href="../../../../../../_variables/uri.html">$uri</a>-&gt;<a class="function" onClick="logFunction('getPort')" href="../../../../../../_functions/getport.html" onMouseOver="funcPopup(event,'getport')">getPort</a>(), <a class="var it553" onMouseOver="hilite(553)" onMouseOut="lolite()" onClick="logVariable('http_ver')" href="../../../../../../_variables/http_ver.html">$http_ver</a>, <a class="var it41" onMouseOver="hilite(41)" onMouseOut="lolite()" onClick="logVariable('headers')" href="../../../../../../_variables/headers.html">$headers</a>);
<a name="l147"><span class="linenum"> 147</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('negotiated')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/negotiated.html">negotiated</a> = true;
<a name="l148"><span class="linenum"> 148</span></a>          }
<a name="l149"><span class="linenum"> 149</span></a>  
<a name="l150"><span class="linenum"> 150</span></a>  <span class="comment">        // Save request method for later</span>
<a name="l151"><span class="linenum"> 151</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('method')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/method.html">method</a> = <a class="var it271" onMouseOver="hilite(271)" onMouseOut="lolite()" onClick="logVariable('method')" href="../../../../../../_variables/method.html">$method</a>;
<a name="l152"><span class="linenum"> 152</span></a>  
<a name="l153"><span class="linenum"> 153</span></a>  <span class="comment">        // Build request headers</span>
<a name="l154"><span class="linenum"> 154</span></a>          if (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('negotiated')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/negotiated.html">negotiated</a>) {
<a name="l155"><span class="linenum"> 155</span></a>              <a class="var it86" onMouseOver="hilite(86)" onMouseOut="lolite()" onClick="logVariable('path')" href="../../../../../../_variables/path.html">$path</a> = <a class="var it38" onMouseOver="hilite(38)" onMouseOut="lolite()" onClick="logVariable('uri')" href="../../../../../../_variables/uri.html">$uri</a>-&gt;<a class="function" onClick="logFunction('getPath')" href="../../../../../../_functions/getpath.html" onMouseOver="funcPopup(event,'getpath')">getPath</a>();
<a name="l156"><span class="linenum"> 156</span></a>              if (<a class="var it38" onMouseOver="hilite(38)" onMouseOut="lolite()" onClick="logVariable('uri')" href="../../../../../../_variables/uri.html">$uri</a>-&gt;<a class="function" onClick="logFunction('getQuery')" href="../../../../../../_functions/getquery.html" onMouseOver="funcPopup(event,'getquery')">getQuery</a>()) {
<a name="l157"><span class="linenum"> 157</span></a>                  <a class="var it86" onMouseOver="hilite(86)" onMouseOut="lolite()" onClick="logVariable('path')" href="../../../../../../_variables/path.html">$path</a> .= '?' . <a class="var it38" onMouseOver="hilite(38)" onMouseOut="lolite()" onClick="logVariable('uri')" href="../../../../../../_variables/uri.html">$uri</a>-&gt;<a class="function" onClick="logFunction('getQuery')" href="../../../../../../_functions/getquery.html" onMouseOver="funcPopup(event,'getquery')">getQuery</a>();
<a name="l158"><span class="linenum"> 158</span></a>              }
<a name="l159"><span class="linenum"> 159</span></a>              <a class="var it278" onMouseOver="hilite(278)" onMouseOut="lolite()" onClick="logVariable('request')" href="../../../../../../_variables/request.html">$request</a> = &quot;<a class="var it271" onMouseOver="hilite(271)" onMouseOut="lolite()" onClick="logVariable('method')" href="../../../../../../_variables/method.html">$method</a> <a class="var it86" onMouseOver="hilite(86)" onMouseOut="lolite()" onClick="logVariable('path')" href="../../../../../../_variables/path.html">$path</a> HTTP/<a class="var it553" onMouseOver="hilite(553)" onMouseOut="lolite()" onClick="logVariable('http_ver')" href="../../../../../../_variables/http_ver.html">$http_ver</a>\r\n&quot;;
<a name="l160"><span class="linenum"> 160</span></a>          } else {
<a name="l161"><span class="linenum"> 161</span></a>              <a class="var it278" onMouseOver="hilite(278)" onMouseOut="lolite()" onClick="logVariable('request')" href="../../../../../../_variables/request.html">$request</a> = &quot;<a class="var it271" onMouseOver="hilite(271)" onMouseOut="lolite()" onClick="logVariable('method')" href="../../../../../../_variables/method.html">$method</a> <a class="var it38" onMouseOver="hilite(38)" onMouseOut="lolite()" onClick="logVariable('uri')" href="../../../../../../_variables/uri.html">$uri</a> HTTP/<a class="var it553" onMouseOver="hilite(553)" onMouseOut="lolite()" onClick="logVariable('http_ver')" href="../../../../../../_variables/http_ver.html">$http_ver</a>\r\n&quot;;
<a name="l162"><span class="linenum"> 162</span></a>          }
<a name="l163"><span class="linenum"> 163</span></a>  
<a name="l164"><span class="linenum"> 164</span></a>  <span class="comment">        // Add all headers to the request string</span>
<a name="l165"><span class="linenum"> 165</span></a>          foreach (<a class="var it41" onMouseOver="hilite(41)" onMouseOut="lolite()" onClick="logVariable('headers')" href="../../../../../../_variables/headers.html">$headers</a> as <a class="var it265" onMouseOver="hilite(265)" onMouseOut="lolite()" onClick="logVariable('k')" href="../../../../../../_variables/k.html">$k</a> =&gt; <a class="var it266" onMouseOver="hilite(266)" onMouseOut="lolite()" onClick="logVariable('v')" href="../../../../../../_variables/v.html">$v</a>) {
<a name="l166"><span class="linenum"> 166</span></a>              if (<a class="phpfunction" onClick="logFunction('is_string')" href="../../../../../../_functions/is_string.html" onMouseOver="phpfuncPopup(event,'is_string')">is_string</a>(<a class="var it265" onMouseOver="hilite(265)" onMouseOut="lolite()" onClick="logVariable('k')" href="../../../../../../_variables/k.html">$k</a>)) <a class="var it266" onMouseOver="hilite(266)" onMouseOut="lolite()" onClick="logVariable('v')" href="../../../../../../_variables/v.html">$v</a> = &quot;<a class="var it265" onMouseOver="hilite(265)" onMouseOut="lolite()" onClick="logVariable('k')" href="../../../../../../_variables/k.html">$k</a>: <a class="var it266" onMouseOver="hilite(266)" onMouseOut="lolite()" onClick="logVariable('v')" href="../../../../../../_variables/v.html">$v</a>&quot;;
<a name="l167"><span class="linenum"> 167</span></a>              <a class="var it278" onMouseOver="hilite(278)" onMouseOut="lolite()" onClick="logVariable('request')" href="../../../../../../_variables/request.html">$request</a> .= &quot;<a class="var it266" onMouseOver="hilite(266)" onMouseOut="lolite()" onClick="logVariable('v')" href="../../../../../../_variables/v.html">$v</a>\r\n&quot;;
<a name="l168"><span class="linenum"> 168</span></a>          }
<a name="l169"><span class="linenum"> 169</span></a>  
<a name="l170"><span class="linenum"> 170</span></a>  <span class="comment">        // Add the request body</span>
<a name="l171"><span class="linenum"> 171</span></a>          <a class="var it278" onMouseOver="hilite(278)" onMouseOut="lolite()" onClick="logVariable('request')" href="../../../../../../_variables/request.html">$request</a> .= &quot;\r\n&quot; . <a class="var it47" onMouseOver="hilite(47)" onMouseOut="lolite()" onClick="logVariable('body')" href="../../../../../../_variables/body.html">$body</a>;
<a name="l172"><span class="linenum"> 172</span></a>  
<a name="l173"><span class="linenum"> 173</span></a>  <span class="comment">        // Send the request</span>
<a name="l174"><span class="linenum"> 174</span></a>          if (! @<a class="phpfunction" onClick="logFunction('fwrite')" href="../../../../../../_functions/fwrite.html" onMouseOver="phpfuncPopup(event,'fwrite')">fwrite</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('socket')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/socket.html">socket</a>, <a class="var it278" onMouseOver="hilite(278)" onMouseOut="lolite()" onClick="logVariable('request')" href="../../../../../../_variables/request.html">$request</a>)) {
<a name="l175"><span class="linenum"> 175</span></a>              require_once 'Zend/Http/Client/Adapter/Exception.php';
<a name="l176"><span class="linenum"> 176</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('Zend_Http_Client_Adapter_Exception')" href="../../../../../../_classes/zend_http_client_adapter_exception.html" onMouseOver="classPopup(event,'zend_http_client_adapter_exception')">Zend_Http_Client_Adapter_Exception</a>(&quot;Error writing request to proxy server&quot;);
<a name="l177"><span class="linenum"> 177</span></a>          }
<a name="l178"><span class="linenum"> 178</span></a>  
<a name="l179"><span class="linenum"> 179</span></a>          return <a class="var it278" onMouseOver="hilite(278)" onMouseOut="lolite()" onClick="logVariable('request')" href="../../../../../../_variables/request.html">$request</a>;
<a name="l180"><span class="linenum"> 180</span></a>      }
<a name="l181"><span class="linenum"> 181</span></a>  
<a name="l182"><span class="linenum"> 182</span></a>      <span class="comment">/**</span>
<a name="l183"><span class="linenum"> 183</span></a>  <span class="comment">     * Preform handshaking with HTTPS proxy using CONNECT method</span>
<a name="l184"><span class="linenum"> 184</span></a>  <span class="comment">     *</span>
<a name="l185"><span class="linenum"> 185</span></a>  <span class="comment">     * @param string  $host</span>
<a name="l186"><span class="linenum"> 186</span></a>  <span class="comment">     * @param integer $port</span>
<a name="l187"><span class="linenum"> 187</span></a>  <span class="comment">     * @param string  $http_ver</span>
<a name="l188"><span class="linenum"> 188</span></a>  <span class="comment">     * @param array   $headers</span>
<a name="l189"><span class="linenum"> 189</span></a>  <span class="comment">     */</span>
<a name="l190"><span class="linenum"> 190</span></a>      protected function <a class="function" onClick="logFunction('connectHandshake')" href="../../../../../../_functions/connecthandshake.html" onMouseOver="funcPopup(event,'connecthandshake')">connectHandshake</a>(<a class="var it268" onMouseOver="hilite(268)" onMouseOut="lolite()" onClick="logVariable('host')" href="../../../../../../_variables/host.html">$host</a>, <a class="var it269" onMouseOver="hilite(269)" onMouseOut="lolite()" onClick="logVariable('port')" href="../../../../../../_variables/port.html">$port</a> = 443, <a class="var it553" onMouseOver="hilite(553)" onMouseOut="lolite()" onClick="logVariable('http_ver')" href="../../../../../../_variables/http_ver.html">$http_ver</a> = '1.1', array &amp;<a class="var it41" onMouseOver="hilite(41)" onMouseOut="lolite()" onClick="logVariable('headers')" href="../../../../../../_variables/headers.html">$headers</a> = array())
<a name="l191"><span class="linenum"> 191</span></a>      {
<a name="l192"><span class="linenum"> 192</span></a>          <a class="var it278" onMouseOver="hilite(278)" onMouseOut="lolite()" onClick="logVariable('request')" href="../../../../../../_variables/request.html">$request</a> = &quot;CONNECT <a class="var it268" onMouseOver="hilite(268)" onMouseOut="lolite()" onClick="logVariable('host')" href="../../../../../../_variables/host.html">$host</a>:<a class="var it269" onMouseOver="hilite(269)" onMouseOut="lolite()" onClick="logVariable('port')" href="../../../../../../_variables/port.html">$port</a> HTTP/<a class="var it553" onMouseOver="hilite(553)" onMouseOut="lolite()" onClick="logVariable('http_ver')" href="../../../../../../_variables/http_ver.html">$http_ver</a>\r\n&quot; .
<a name="l193"><span class="linenum"> 193</span></a>                     &quot;Host: &quot; . <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/config.html">config</a>['proxy_host'] . &quot;\r\n&quot;;
<a name="l194"><span class="linenum"> 194</span></a>  
<a name="l195"><span class="linenum"> 195</span></a>  <span class="comment">        // Add the user-agent header</span>
<a name="l196"><span class="linenum"> 196</span></a>          if (isset(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/config.html">config</a>['useragent'])) {
<a name="l197"><span class="linenum"> 197</span></a>              <a class="var it278" onMouseOver="hilite(278)" onMouseOut="lolite()" onClick="logVariable('request')" href="../../../../../../_variables/request.html">$request</a> .= &quot;User-agent: &quot; . <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('config')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/config.html">config</a>['useragent'] . &quot;\r\n&quot;;
<a name="l198"><span class="linenum"> 198</span></a>          }
<a name="l199"><span class="linenum"> 199</span></a>  
<a name="l200"><span class="linenum"> 200</span></a>  <span class="comment">        // If the proxy-authorization header is set, send it to proxy but remove</span>
<a name="l201"><span class="linenum"> 201</span></a>  <span class="comment">        // it from headers sent to target host</span>
<a name="l202"><span class="linenum"> 202</span></a>          if (isset(<a class="var it41" onMouseOver="hilite(41)" onMouseOut="lolite()" onClick="logVariable('headers')" href="../../../../../../_variables/headers.html">$headers</a>['proxy-authorization'])) {
<a name="l203"><span class="linenum"> 203</span></a>              <a class="var it278" onMouseOver="hilite(278)" onMouseOut="lolite()" onClick="logVariable('request')" href="../../../../../../_variables/request.html">$request</a> .= &quot;Proxy-authorization: &quot; . <a class="var it41" onMouseOver="hilite(41)" onMouseOut="lolite()" onClick="logVariable('headers')" href="../../../../../../_variables/headers.html">$headers</a>['proxy-authorization'] . &quot;\r\n&quot;;
<a name="l204"><span class="linenum"> 204</span></a>              unset(<a class="var it41" onMouseOver="hilite(41)" onMouseOut="lolite()" onClick="logVariable('headers')" href="../../../../../../_variables/headers.html">$headers</a>['proxy-authorization']);
<a name="l205"><span class="linenum"> 205</span></a>          }
<a name="l206"><span class="linenum"> 206</span></a>  
<a name="l207"><span class="linenum"> 207</span></a>          <a class="var it278" onMouseOver="hilite(278)" onMouseOut="lolite()" onClick="logVariable('request')" href="../../../../../../_variables/request.html">$request</a> .= &quot;\r\n&quot;;
<a name="l208"><span class="linenum"> 208</span></a>  
<a name="l209"><span class="linenum"> 209</span></a>  <span class="comment">        // Send the request</span>
<a name="l210"><span class="linenum"> 210</span></a>          if (! @<a class="phpfunction" onClick="logFunction('fwrite')" href="../../../../../../_functions/fwrite.html" onMouseOver="phpfuncPopup(event,'fwrite')">fwrite</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('socket')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/socket.html">socket</a>, <a class="var it278" onMouseOver="hilite(278)" onMouseOut="lolite()" onClick="logVariable('request')" href="../../../../../../_variables/request.html">$request</a>)) {
<a name="l211"><span class="linenum"> 211</span></a>              require_once 'Zend/Http/Client/Adapter/Exception.php';
<a name="l212"><span class="linenum"> 212</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('Zend_Http_Client_Adapter_Exception')" href="../../../../../../_classes/zend_http_client_adapter_exception.html" onMouseOver="classPopup(event,'zend_http_client_adapter_exception')">Zend_Http_Client_Adapter_Exception</a>(&quot;Error writing request to proxy server&quot;);
<a name="l213"><span class="linenum"> 213</span></a>          }
<a name="l214"><span class="linenum"> 214</span></a>  
<a name="l215"><span class="linenum"> 215</span></a>  <span class="comment">        // Read response headers only</span>
<a name="l216"><span class="linenum"> 216</span></a>          <a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../../../_variables/response.html">$response</a> = '';
<a name="l217"><span class="linenum"> 217</span></a>          <a class="var it554" onMouseOver="hilite(554)" onMouseOut="lolite()" onClick="logVariable('gotStatus')" href="../../../../../../_variables/gotStatus.html">$gotStatus</a> = false;
<a name="l218"><span class="linenum"> 218</span></a>          while (<a class="var it296" onMouseOver="hilite(296)" onMouseOut="lolite()" onClick="logVariable('line')" href="../../../../../../_variables/line.html">$line</a> = @<a class="phpfunction" onClick="logFunction('fgets')" href="../../../../../../_functions/fgets.html" onMouseOver="phpfuncPopup(event,'fgets')">fgets</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('socket')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/socket.html">socket</a>)) {
<a name="l219"><span class="linenum"> 219</span></a>              <a class="var it554" onMouseOver="hilite(554)" onMouseOut="lolite()" onClick="logVariable('gotStatus')" href="../../../../../../_variables/gotStatus.html">$gotStatus</a> = <a class="var it554" onMouseOver="hilite(554)" onMouseOut="lolite()" onClick="logVariable('gotStatus')" href="../../../../../../_variables/gotStatus.html">$gotStatus</a> || (<a class="phpfunction" onClick="logFunction('strpos')" href="../../../../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it296" onMouseOver="hilite(296)" onMouseOut="lolite()" onClick="logVariable('line')" href="../../../../../../_variables/line.html">$line</a>, 'HTTP') !== false);
<a name="l220"><span class="linenum"> 220</span></a>              if (<a class="var it554" onMouseOver="hilite(554)" onMouseOut="lolite()" onClick="logVariable('gotStatus')" href="../../../../../../_variables/gotStatus.html">$gotStatus</a>) {
<a name="l221"><span class="linenum"> 221</span></a>                  <a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../../../_variables/response.html">$response</a> .= <a class="var it296" onMouseOver="hilite(296)" onMouseOut="lolite()" onClick="logVariable('line')" href="../../../../../../_variables/line.html">$line</a>;
<a name="l222"><span class="linenum"> 222</span></a>                  if (!chop(<a class="var it296" onMouseOver="hilite(296)" onMouseOut="lolite()" onClick="logVariable('line')" href="../../../../../../_variables/line.html">$line</a>)) break;
<a name="l223"><span class="linenum"> 223</span></a>              }
<a name="l224"><span class="linenum"> 224</span></a>          }
<a name="l225"><span class="linenum"> 225</span></a>  
<a name="l226"><span class="linenum"> 226</span></a>  <span class="comment">        // Check that the response from the proxy is 200</span>
<a name="l227"><span class="linenum"> 227</span></a>          if (<a class="class" onClick="logClass('Zend_Http_Response')" href="../../../../../../_classes/zend_http_response.html" onMouseOver="classPopup(event,'zend_http_response')">Zend_Http_Response</a>::<a class="function" onClick="logFunction('extractCode')" href="../../../../../../_functions/extractcode.html" onMouseOver="funcPopup(event,'extractcode')">extractCode</a>(<a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../../../_variables/response.html">$response</a>) != 200) {
<a name="l228"><span class="linenum"> 228</span></a>              require_once 'Zend/Http/Client/Adapter/Exception.php';
<a name="l229"><span class="linenum"> 229</span></a>              throw <span class="keyword">new </span><a class="class" onClick="logClass('Zend_Http_Client_Adapter_Exception')" href="../../../../../../_classes/zend_http_client_adapter_exception.html" onMouseOver="classPopup(event,'zend_http_client_adapter_exception')">Zend_Http_Client_Adapter_Exception</a>(&quot;Unable to connect to HTTPS proxy. Server response: &quot; . <a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../../../_variables/response.html">$response</a>);
<a name="l230"><span class="linenum"> 230</span></a>          }
<a name="l231"><span class="linenum"> 231</span></a>  
<a name="l232"><span class="linenum"> 232</span></a>  <span class="comment">        // If all is good, switch socket to secure mode. We have to fall back</span>
<a name="l233"><span class="linenum"> 233</span></a>  <span class="comment">        // through the different modes</span>
<a name="l234"><span class="linenum"> 234</span></a>          <a class="var it1161" onMouseOver="hilite(1161)" onMouseOut="lolite()" onClick="logVariable('modes')" href="../../../../../../_variables/modes.html">$modes</a> = array(
<a name="l235"><span class="linenum"> 235</span></a>              STREAM_CRYPTO_METHOD_TLS_CLIENT,
<a name="l236"><span class="linenum"> 236</span></a>              STREAM_CRYPTO_METHOD_SSLv3_CLIENT,
<a name="l237"><span class="linenum"> 237</span></a>              STREAM_CRYPTO_METHOD_SSLv23_CLIENT,
<a name="l238"><span class="linenum"> 238</span></a>              STREAM_CRYPTO_METHOD_SSLv2_CLIENT
<a name="l239"><span class="linenum"> 239</span></a>          );
<a name="l240"><span class="linenum"> 240</span></a>  
<a name="l241"><span class="linenum"> 241</span></a>          <a class="var it352" onMouseOver="hilite(352)" onMouseOut="lolite()" onClick="logVariable('success')" href="../../../../../../_variables/success.html">$success</a> = false;
<a name="l242"><span class="linenum"> 242</span></a>          foreach(<a class="var it1161" onMouseOver="hilite(1161)" onMouseOut="lolite()" onClick="logVariable('modes')" href="../../../../../../_variables/modes.html">$modes</a> as <a class="var it824" onMouseOver="hilite(824)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../../../../../../_variables/mode.html">$mode</a>) {
<a name="l243"><span class="linenum"> 243</span></a>              <a class="var it352" onMouseOver="hilite(352)" onMouseOut="lolite()" onClick="logVariable('success')" href="../../../../../../_variables/success.html">$success</a> = stream_socket_enable_crypto(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('socket')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/socket.html">socket</a>, true, <a class="var it824" onMouseOver="hilite(824)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../../../../../../_variables/mode.html">$mode</a>);
<a name="l244"><span class="linenum"> 244</span></a>              if (<a class="var it352" onMouseOver="hilite(352)" onMouseOut="lolite()" onClick="logVariable('success')" href="../../../../../../_variables/success.html">$success</a>) break;
<a name="l245"><span class="linenum"> 245</span></a>          }
<a name="l246"><span class="linenum"> 246</span></a>  
<a name="l247"><span class="linenum"> 247</span></a>          if (! <a class="var it352" onMouseOver="hilite(352)" onMouseOut="lolite()" onClick="logVariable('success')" href="../../../../../../_variables/success.html">$success</a>) {
<a name="l248"><span class="linenum"> 248</span></a>                  require_once 'Zend/Http/Client/Adapter/Exception.php';
<a name="l249"><span class="linenum"> 249</span></a>                  throw <span class="keyword">new </span><a class="class" onClick="logClass('Zend_Http_Client_Adapter_Exception')" href="../../../../../../_classes/zend_http_client_adapter_exception.html" onMouseOver="classPopup(event,'zend_http_client_adapter_exception')">Zend_Http_Client_Adapter_Exception</a>(&quot;Unable to connect to&quot; .
<a name="l250"><span class="linenum"> 250</span></a>                      &quot; HTTPS server through proxy: could not negotiate secure connection.&quot;);
<a name="l251"><span class="linenum"> 251</span></a>          }
<a name="l252"><span class="linenum"> 252</span></a>      }
<a name="l253"><span class="linenum"> 253</span></a>  
<a name="l254"><span class="linenum"> 254</span></a>      <span class="comment">/**</span>
<a name="l255"><span class="linenum"> 255</span></a>  <span class="comment">     * Close the connection to the server</span>
<a name="l256"><span class="linenum"> 256</span></a>  <span class="comment">     *</span>
<a name="l257"><span class="linenum"> 257</span></a>  <span class="comment">     */</span>
<a name="l258"><span class="linenum"> 258</span></a>      public function <a class="function" onClick="logFunction('close')" href="../../../../../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>()
<a name="l259"><span class="linenum"> 259</span></a>      {
<a name="l260"><span class="linenum"> 260</span></a>          parent::<a class="function" onClick="logFunction('close')" href="../../../../../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l261"><span class="linenum"> 261</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('negotiated')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/negotiated.html">negotiated</a> = false;
<a name="l262"><span class="linenum"> 262</span></a>      }
<a name="l263"><span class="linenum"> 263</span></a>  
<a name="l264"><span class="linenum"> 264</span></a>      <span class="comment">/**</span>
<a name="l265"><span class="linenum"> 265</span></a>  <span class="comment">     * Destructor: make sure the socket is disconnected</span>
<a name="l266"><span class="linenum"> 266</span></a>  <span class="comment">     *</span>
<a name="l267"><span class="linenum"> 267</span></a>  <span class="comment">     */</span>
<a name="l268"><span class="linenum"> 268</span></a>      public function <a class="function" onClick="logFunction('__destruct')" href="../../../../../../_functions/__destruct.html" onMouseOver="funcPopup(event,'__destruct')">__destruct</a>()
<a name="l269"><span class="linenum"> 269</span></a>      {
<a name="l270"><span class="linenum"> 270</span></a>          if (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('socket')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../../../_variables/socket.html">socket</a>) <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('close')" href="../../../../../../_functions/close.html" onMouseOver="funcPopup(event,'close')">close</a>();
<a name="l271"><span class="linenum"> 271</span></a>      }
<a name="l272"><span class="linenum"> 272</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'encodeauthheader': ['encodeauthheader', 'Create a HTTP authentication "Authorization:" header according to the specified user, password and authentication method. ', [['admin/oauth/Zend/Http','Client.php',1371]], 3],
'getscheme': ['getscheme', '', [['admin/oauth/Zend/Gdata/App/Extension','Category.php',107],['admin/oauth/Zend/Gdata/YouTube/Extension','MediaRating.php',116],['admin/oauth/Zend','Uri.php',135],['admin/oauth/Zend/Gdata/YouTube/Extension','MediaCredit.php',154],['admin/oauth/Zend/Gdata/Media/Extension','MediaRating.php',103],['admin/oauth/Zend/Gdata/Media/Extension','MediaCategory.php',109],['admin/oauth/Zend/Gdata/Media/Extension','MediaCredit.php',134]], 12],
'getport': ['getport', 'Returns the TCP port, or FALSE if none. ', [['admin/oauth/Zend/Uri','Http.php',472]], 10],
'gethost': ['gethost', 'Returns the domain or host IP portion of the URL, or FALSE if none. ', [['admin/oauth/Zend/Uri','Http.php',417]], 8],
'connecthandshake': ['connecthandshake', 'Preform handshaking with HTTPS proxy using CONNECT method ', [['admin/oauth/Zend/Http/Client/Adapter','Proxy.php',182]], 2],
'close': ['close', 'Close the connection to the server ', [['admin/oauth/Zend/Http/Client/Adapter','Curl.php',454],['admin/oauth/Zend/Http/Client/Adapter','Socket.php',478],['admin/oauth/Zend/Http/Client/Adapter','Proxy.php',254],['admin/oauth/Zend/Gdata/App','LoggingHttpClientAdapterSocket.php',109],['admin/oauth/Zend/Http/Client/Adapter','Test.php',187],['admin/oauth/Zend/Http/Client/Adapter','Interface.php',73]], 49],
'getquery': ['getquery', 'Gets the query data from the server environment based on the request method used.  If GET was used, this looks at $_SERVER[\'QUERY_STRING\'] directly.  If POST was used, this fetches data from the special php://input file stream. ', [['admin/oauth/Auth','OpenID.php',128],['admin/oauth/Zend/Gdata','Query.php',296],['admin/oauth/Zend/Uri','Http.php',584]], 12],
'getpath': ['getpath', 'Returns the path and filename portion of the URL, or FALSE if none. ', [['admin/oauth/Zend/Uri','Http.php',524]], 5],
'extractcode': ['extractcode', 'Extract the response code from a response string ', [['admin/oauth/Zend/Http','Response.php',436]], 4],
'__destruct': ['__destruct', 'Destructor: make sure the socket is disconnected ', [['admin/oauth/Zend/Http/Client/Adapter','Socket.php',523],['admin/oauth/Zend/Http/Response','Stream.php',224],['admin/oauth/Zend/Http/Client/Adapter','Proxy.php',264],['','execute_query.php',35],['admin/oauth','OAuth.php',688]], 0],
'write': ['write', 'Send request to the remote server ', [['admin/oauth/Zend/Http/Client/Adapter','Curl.php',250],['admin/oauth/Zend/Http/Client/Adapter','Socket.php',250],['admin/oauth/Zend/Gdata','HttpAdapterStreamingProxy.php',48],['admin/oauth/Zend/Http/Client/Adapter','Proxy.php',108],['admin/oauth/Zend/Gdata/App','LoggingHttpClientAdapterSocket.php',80],['admin/oauth/Zend/Http/Client/Adapter','Test.php',142],['admin/oauth/Zend/Gdata','HttpAdapterStreamingSocket.php',49],['admin/oauth/Zend/Http/Client/Adapter','Interface.php',54]], 86],
'connect': ['connect', 'Initialize curl ', [['admin/oauth/Zend/Http/Client/Adapter','Curl.php',192],['admin/oauth/Zend/Http/Client/Adapter','Socket.php',185],['admin/oauth/Zend/Http/Client/Adapter','Proxy.php',78],['admin/oauth/Zend/Gdata/App','LoggingHttpClientAdapterSocket.php',66],['admin/oauth/Zend/Http/Client/Adapter','Test.php',124],['admin/oauth/Zend/Http/Client/Adapter','Interface.php',45]], 4],
'fgets': ['fgets', '', [], 11],
'strpos': ['strpos', '', [], 73],
'is_string': ['is_string', '', [], 33],
'fwrite': ['fwrite', '', [], 14]};
CLASS_DATA={
'zend_http_response': ['zend_http_response', 'Zend_Http_Response represents an HTTP 1.0 / 1.1 response message. It includes easy access to all the response\'s different elemts, as well as some convenience methods for parsing and validating HTTP responses. ', [['admin/oauth/Zend/Http','Response.php',24]], 6],
'zend_http_client_adapter_exception': ['zend_http_client_adapter_exception', '', [['admin/oauth/Zend/Http/Client/Adapter','Exception.php',35]], 40],
'zend_http_client': ['zend_http_client', 'Zend_Http_Client is an implemetation of an HTTP client in PHP. The client supports basic features like sending different HTTP requests and handling redirections, as well as more advanced features like proxy settings, HTTP authentication and cookie persistance (using a Zend_Http_CookieJar object) ', [['admin/oauth/Zend/Http','Client.php',52]], 17],
'zend_http_client_adapter_proxy': ['zend_http_client_adapter_proxy', 'HTTP Proxy-supporting Zend_Http_Client adapter class, based on the default socket based adapter. ', [['admin/oauth/Zend/Http/Client/Adapter','Proxy.php',37]], 1],
'zend_http_client_adapter_socket': ['zend_http_client_adapter_socket', 'A sockets based (stream_socket_client) adapter class for Zend_Http_Client. Can be used on almost every PHP environment, and does not require any special extensions. ', [['admin/oauth/Zend/Http/Client/Adapter','Socket.php',37]], 3]};
CONST_DATA={
};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Tue Dec  7 15:36:31 2010</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7</a></i></td>
	</tr>
</table>
</body></html>
